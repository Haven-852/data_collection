
import pandas as pd

# 构建问卷数据（每行代表一个问题，单选题）
questions = [
    # 一、基础信息
    ["您的年龄？", ["18岁以下", "18-30岁", "31-45岁", "46-60岁", "60岁以上"]],
    ["您的性别？", ["男", "女", "其他"]],
    ["您的最高学历？", ["小学及以下", "初中", "高中/中专", "本科", "研究生及以上"]],
    ["您目前居住在哪类地区？", ["城市", "县级市", "农村"]],
    ["您是否经常就医？", ["是", "否"]],
    ["您是否患有慢性疾病？", ["是", "否"]],
    ["您是否接触过AI医疗产品？", ["是", "否"]],

    # 二、认知维度
    ["您是否听说过AI辅助诊断、AI医生等？", ["是", "否"]],
    ["您了解AI在医疗中的哪些应用场景？", ["医疗影像识别", "辅助诊断", "药物推荐", "不清楚"]],
    ["您最初是通过哪种途径了解AI医疗的？", ["医生介绍", "新闻报道", "互联网搜索", "朋友推荐", "不了解"]],

    # 三、接受意愿与使用体验
    ["您是否愿意在就诊过程中使用AI辅助系统？", ["愿意", "不愿意", "视情况而定"]],
    ["当AI与医生意见不一致时，您更信任？", ["AI系统", "医生", "都不信任", "难以判断"]],
    ["您是否使用过智能导诊、AI健康问答等服务？", ["使用过", "听说过但没用过", "没听说过"]],
    ["您对AI医疗的总体体验如何？", ["准确", "快捷", "方便", "不满意", "未使用"]],

    # 四、信任与风险认知
    ["您对AI诊断结果的信任程度？", ["完全不信任", "较不信任", "一般", "较信任", "非常信任"]],
    ["您最担心AI医疗带来的问题是？", ["错诊漏诊", "数据泄露", "无法理解", "被医生替代", "其他"]],
    ["您是否希望医生介入监督AI诊断结果？", ["是", "否", "无所谓"]],

    # 五、隐私与数据使用态度
    ["您是否愿意将个人健康数据用于AI训练？", ["愿意", "不愿意", "视情况而定"]],
    ["您对个人隐私泄露的担忧程度？", ["不担心", "稍微担心", "比较担心", "非常担心"]],
    ["如果数据已匿名化，您是否接受其用于科研？", ["接受", "不接受", "不确定"]],
    ["您希望谁来监管AI的数据使用？", ["政府", "医院", "第三方独立机构", "不需要监管"]],

    # 六、经济与社会价值感知
    ["您是否认为AI医疗有助于缓解医生资源紧张？", ["是", "否", "不确定"]],
    ["您是否接受AI作为初诊手段？", ["接受", "不接受", "取决于场景"]],
    ["您愿意为AI医疗支付的费用为？", ["不愿意支付", "0-20元", "20-50元", "50元以上"]],
    ["您是否担心AI加剧“技术鸿沟”带来的不公平？", ["担心", "不担心", "不了解"]]
]

# 转换为DataFrame
question_data = []
for idx, (q, opts) in enumerate(questions, start=1):
    question_data.append({
        "编号": f"Q{idx}",
        "问题": q,
        "选项（单选）": " / ".join(opts)
    })

df_questionnaire = pd.DataFrame(question_data)

# 保存为Excel文件
output_path = "pal/患者AI医疗接受度问卷_单选版.xlsx"
df_questionnaire.to_csv("患者AI医疗接受度问卷_单选版.csv", index=False)
